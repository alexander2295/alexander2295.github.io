<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Simulador de Eventos GA4 - OLVA</title>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PBZY0KMFNH"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PBZY0KMFNH');
  </script>

  <style>
    body { font-family: sans-serif; margin: 30px; }
    input, button { padding: 10px; margin: 5px 10px 5px 0; }
    #form_pagar { border: 1px solid #ccc; padding: 15px; margin-top: 10px; background: #f9f9f9; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>

  <h1>Simulador de Eventos con Google Analytics</h1>

  <!-- Formulario de cliente -->
  <label for="cliente_nombre">Nombre del Cliente:</label><br>
  <input type="text" id="cliente_nombre" placeholder="Ej: Juan Perez"><br>
  
  <label for="cliente_id">ID del Cliente:</label><br>
  <input type="text" id="cliente_id" placeholder="Ej: cliente_001"><br>

  <label for="producto">Producto:</label><br>
  <input type="text" id="producto" placeholder="Ej: Televisor"><br>

  <button onclick="registrarPago()">Pagar</button>
  <button onclick="retirarCliente()">Retirar</button>

  <!-- Tabla de usuarios -->
  <h2>Clientes Registrados</h2>
  <table id="tabla_clientes">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>ID</th>
        <th>Producto</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    function enviarEvento(nombreEvento, parametros = {}) {
      gtag('event', nombreEvento, parametros);
    }

    function registrarPago() {
      const nombre = document.getElementById('cliente_nombre').value.trim();
      const id = document.getElementById('cliente_id').value.trim();
      const producto = document.getElementById('producto').value.trim();

      if (!nombre || !id || !producto) {
        alert("Por favor completa todos los campos.");
        return;
      }

      alert("¿Pagar? Cliente: " + nombre);
      enviarEvento('pago_realizado', { cliente_id: id, nombre_cliente: nombre, producto });

      const tabla = document.getElementById('tabla_clientes').getElementsByTagName('tbody')[0];
      const fila = tabla.insertRow();
      fila.insertCell(0).textContent = nombre;
      fila.insertCell(1).textContent = id;
      fila.insertCell(2).textContent = producto;

      document.getElementById('cliente_nombre').value = "";
      document.getElementById('cliente_id').value = "";
      document.getElementById('producto').value = "";
    }

    function retirarCliente() {
      const tabla = document.getElementById('tabla_clientes').getElementsByTagName('tbody')[0];
      if (tabla.rows.length === 0) {
        alert("No hay clientes para retirar.");
        return;
      }

      const cliente = tabla.rows[tabla.rows.length - 1];
      const nombre = cliente.cells[0].textContent;
      const id = cliente.cells[1].textContent;
      const producto = cliente.cells[2].textContent;

      alert("¿Retirar? Cliente: " + nombre);
      enviarEvento('cliente_retirado', { cliente_id: id, nombre_cliente: nombre, producto });

      tabla.deleteRow(tabla.rows.length - 1);
    }
  </script>
</body>
</html>
